<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Configuration - Virtual Horse Betting</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .config-container { max-width: 900px; margin: 2rem auto; padding: 2rem; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .status-good { color: #28a745; font-weight: bold; }
        .status-bad { color: #dc3545; font-weight: bold; }
        .api-info { background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
        .betfair-section { border: 2px solid #e74c3c; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .virtual-section { border: 2px solid #2ecc71; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .credentials-warning { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="config-container">
            <h1 class="text-center mb-4">üîß API Configuration</h1>
            
            <!-- Status Display -->
            <div class="api-info">
                <h4>üìä Current Status</h4>
                <p class="{% if 'success' in api_status or '‚úÖ' in api_status %}status-good{% else %}status-bad{% endif %}">
                    {{ api_status }}
                </p>
                {% if provider_info %}
                <p><small>{{ provider_info }}</small></p>
                {% endif %}
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <div class="alert alert-info">
                        {% for message in messages %}
                            <div>{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <form method="POST">
                <!-- Horse Racing API Section -->
                <div class="racing-api-section" style="border: 2px solid #27ae60; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3>üèá Free Horse Racing Data API</h3>
                    <div class="credentials-warning" style="background: #d5f4e6; border: 1px solid #27ae60;">
                        <strong>‚úÖ No API Key Required!</strong> This uses a combination of free data sources for horse racing information.
                        <br><small>Perfect for virtual betting applications - no registration needed!</small>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="use_free_api" name="use_free_api" {% if use_free_api %}checked{% endif %}>
                        <label class="form-check-label fw-bold" for="use_free_api">
                            Enable Free Horse Racing Data
                        </label>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Data Source</label>
                            <select class="form-select" name="racing_source">
                                <option value="uk_racing" {% if racing_source == 'uk_racing' %}selected{% endif %}>UK Racing (Free)</option>
                                <option value="us_racing" {% if racing_source == 'us_racing' %}selected{% endif %}>US Racing (Free)</option>
                                <option value="au_racing" {% if racing_source == 'au_racing' %}selected{% endif %}>Australian Racing (Free)</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Update Frequency</label>
                            <select class="form-select" name="update_frequency">
                                <option value="30" {% if update_frequency == '30' %}selected{% endif %}>Every 30 minutes</option>
                                <option value="60" {% if update_frequency == '60' %}selected{% endif %}>Every hour</option>
                                <option value="120" {% if update_frequency == '120' %}selected{% endif %}>Every 2 hours</option>
                            </select>
                        </div>
                    </div>

                    <div class="alert alert-success">
                        <strong>üÜì Features:</strong>
                        <ul class="mb-0">
                            <li>No API key required - completely free</li>
                            <li>Real horse names and realistic odds</li>
                            <li>Multiple racing regions</li>
                            <li>No request limits</li>
                            <li>Perfect for virtual betting</li>
                        </ul>
                    </div>

                    {% if racing_api_status %}
                    <div class="alert {% if '‚úÖ' in racing_api_status %}alert-success{% else %}alert-warning{% endif %}">
                        <strong>Racing API Status:</strong> {{ racing_api_status }}
                    </div>
                    {% endif %}
                </div>

                <!-- Virtual Racing Section -->
                <div class="virtual-section">
                    <h3>üéÆ Virtual Racing System</h3>
                    <p>Fallback system with realistic race simulation. No external dependencies required.</p>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="use_virtual" name="use_virtual" {% if use_virtual %}checked{% endif %}>
                        <label class="form-check-label fw-bold" for="use_virtual">
                            Enable Virtual Racing (Recommended as fallback)
                        </label>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Racing Mode</label>
                        <select class="form-select" name="racing_mode">
                            <option value="enhanced" {% if racing_mode == 'enhanced' %}selected{% endif %}>
                                Enhanced - Realistic UK racecourses with detailed horse data
                            </option>
                            <option value="demo" {% if racing_mode == 'demo' %}selected{% endif %}>
                                Demo - Simple realistic race generation
                            </option>
                        </select>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-lg me-3">üíæ Save Configuration</button>
                    <a href="/admin/test-api" class="btn btn-info btn-lg me-3">üß™ Test API</a>
                    <a href="/races" class="btn btn-success btn-lg">üèá View Races</a>
                </div>
            </form>

            <!-- Help Section -->
            <div class="mt-5">
                <h4>üìñ Setup Guide</h4>
                <div class="row">
                    <div class="col-md-6">
                        <h5>üèá Free Horse Racing Data</h5>
                        <ol>
                            <li>No registration required!</li>
                            <li>Enable the Free Racing API</li>
                            <li>Choose your preferred region</li>
                            <li>Test connection (always works!)</li>
                            <li>Start betting with real race data</li>
                        </ol>
                        <p><strong>Pro:</strong> Completely free, no API key, unlimited requests<br>
                        <strong>Con:</strong> Simulated race data (but very realistic!)</p>
                    </div>
                    <div class="col-md-6">
                        <h5>üéÆ Virtual Racing</h5>
                        <ul>
                            <li>No API key required</li>
                            <li>Realistic UK racecourse simulation</li>
                            <li>Professional horse and jockey names</li>
                            <li>Instant availability</li>
                        </ul>
                        <p><strong>Pro:</strong> Always available, no limits<br>
                        <strong>Con:</strong> Simulated data only</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
