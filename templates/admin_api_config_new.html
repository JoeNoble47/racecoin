<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Configuration - Virtual Horse Betting</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .config-container { max-width: 900px; margin: 2rem auto; padding: 2rem; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .status-good { color: #28a745; font-weight: bold; }
        .status-bad { color: #dc3545; font-weight: bold; }
        .api-info { background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
        .betfair-section { border: 2px solid #e74c3c; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .virtual-section { border: 2px solid #2ecc71; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .credentials-warning { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="config-container">
            <h1 class="text-center mb-4">üîß API Configuration</h1>
            
            <!-- Status Display -->
            <div class="api-info">
                <h4>üìä Current Status</h4>
                <p class="{% if 'success' in api_status or '‚úÖ' in api_status %}status-good{% else %}status-bad{% endif %}">
                    {{ api_status }}
                </p>
                {% if provider_info %}
                <p><small>{{ provider_info }}</small></p>
                {% endif %}
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <div class="alert alert-info">
                        {% for message in messages %}
                            <div>{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <form method="POST">
                <!-- SportMonks Horse Racing API Section -->
                <div class="sportmonks-api-section" style="border: 2px solid #e67e22; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3>üèá SportMonks Horse Racing API</h3>
                    <div class="credentials-warning">
                        <strong>‚ö†Ô∏è Note:</strong> Free tier includes 180 requests/day. Excellent for virtual betting games!
                        <br><small>Visit <a href="https://www.sportmonks.com/horse-racing-api" target="_blank">SportMonks Horse Racing API</a> to get your free API key.</small>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="use_sportmonks" name="use_sportmonks" {% if use_sportmonks %}checked{% endif %}>
                        <label class="form-check-label fw-bold" for="use_sportmonks">
                            Enable SportMonks Horse Racing API
                        </label>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">API Key</label>
                        <input type="text" class="form-control" name="sportmonks_api_key" 
                               value="{{ sportmonks_api_key }}" placeholder="Your SportMonks API Key">
                        <small class="text-muted">Get your free API key from sportmonks.com</small>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Region</label>
                            <select class="form-select" name="sportmonks_region">
                                <option value="uk" {% if sportmonks_region == 'uk' %}selected{% endif %}>United Kingdom</option>
                                <option value="us" {% if sportmonks_region == 'us' %}selected{% endif %}>United States</option>
                                <option value="au" {% if sportmonks_region == 'au' %}selected{% endif %}>Australia</option>
                                <option value="ie" {% if sportmonks_region == 'ie' %}selected{% endif %}>Ireland</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Update Frequency</label>
                            <select class="form-select" name="update_frequency">
                                <option value="30" {% if update_frequency == '30' %}selected{% endif %}>Every 30 minutes</option>
                                <option value="60" {% if update_frequency == '60' %}selected{% endif %}>Every hour</option>
                                <option value="120" {% if update_frequency == '120' %}selected{% endif %}>Every 2 hours</option>
                            </select>
                        </div>
                    </div>

                    {% if sportmonks_api_status %}
                    <div class="alert {% if '‚úÖ' in sportmonks_api_status %}alert-success{% else %}alert-warning{% endif %}">
                        <strong>SportMonks API Status:</strong> {{ sportmonks_api_status }}
                    </div>
                    {% endif %}
                </div>

                <!-- Virtual Racing Section -->
                <div class="virtual-section">
                    <h3>üéÆ Virtual Racing System</h3>
                    <p>Fallback system with realistic race simulation. No external dependencies required.</p>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="use_virtual" name="use_virtual" {% if use_virtual %}checked{% endif %}>
                        <label class="form-check-label fw-bold" for="use_virtual">
                            Enable Virtual Racing (Recommended as fallback)
                        </label>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Racing Mode</label>
                        <select class="form-select" name="racing_mode">
                            <option value="enhanced" {% if racing_mode == 'enhanced' %}selected{% endif %}>
                                Enhanced - Realistic UK racecourses with detailed horse data
                            </option>
                            <option value="demo" {% if racing_mode == 'demo' %}selected{% endif %}>
                                Demo - Simple realistic race generation
                            </option>
                        </select>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-lg me-3">üíæ Save Configuration</button>
                    <a href="/admin/test-api" class="btn btn-info btn-lg me-3">üß™ Test API</a>
                    <a href="/races" class="btn btn-success btn-lg">üèá View Races</a>
                </div>
            </form>

            <!-- Help Section -->
            <div class="mt-5">
                <h4>üìñ Setup Guide</h4>
                <div class="row">
                    <div class="col-md-6">
                        <h5>üèá SportMonks Horse Racing API</h5>
                        <ol>
                            <li>Visit <a href="https://www.sportmonks.com/horse-racing-api" target="_blank">sportmonks.com</a></li>
                            <li>Sign up for a free account</li>
                            <li>Get your API key from the dashboard</li>
                            <li>Choose your preferred racing region</li>
                            <li>Enable the API and test connection</li>
                        </ol>
                        <p><strong>Pro:</strong> 180 requests/day free, comprehensive horse racing data, reliable<br>
                        <strong>Con:</strong> Daily request limit</p>
                    </div>
                    <div class="col-md-6">
                        <h5>üéÆ Virtual Racing</h5>
                        <ul>
                            <li>No API key required</li>
                            <li>Realistic UK racecourse simulation</li>
                            <li>Professional horse and jockey names</li>
                            <li>Instant availability</li>
                        </ul>
                        <p><strong>Pro:</strong> Always available, no limits<br>
                        <strong>Con:</strong> Simulated data only</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
