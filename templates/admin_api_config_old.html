<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Configuration - Virtual Horse Betting</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .config-container { max-width: 900px; margin: 2rem auto; padding: 2rem; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .status-good { color: #28a745; font-weight: bold; }
        .status-bad { color: #dc3545; font-weight: bold; }
        .api-info { background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
        .betfair-section { border: 2px solid #e74c3c; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .virtual-section { border: 2px solid #2ecc71; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .credentials-warning { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="config-container">
            <h1 class="text-center mb-4">üîß API Configuration</h1>
            
            <!-- Status Display -->
            <div class="api-info">
                <h4>üìä Current Status</h4>
                <p class="{% if 'success' in api_status or '‚úÖ' in api_status %}status-good{% else %}status-bad{% endif %}">
                    {{ api_status }}
                </p>
                {% if provider_info %}
                <p><small>{{ provider_info }}</small></p>
                {% endif %}
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <div class="alert alert-info">
                        {% for message in messages %}
                            <div>{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <form method="POST">
                <!-- The Odds API Section -->
                <div class="odds-api-section" style="border: 2px solid #3498db; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3>üèá The Odds API - Horse Racing</h3>
                    <div class="credentials-warning">
                        <strong>‚ö†Ô∏è Note:</strong> Free tier includes 500 requests/month. Perfect for virtual betting games!
                        <br><small>Visit <a href="https://the-odds-api.com/" target="_blank">The Odds API</a> to get your free API key.</small>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="use_odds_api" name="use_odds_api" {% if use_odds_api %}checked{% endif %}>
                        <label class="form-check-label fw-bold" for="use_odds_api">
                            Enable The Odds API
                        </label>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">API Key</label>
                        <input type="text" class="form-control" name="odds_api_key" 
                               value="{{ odds_api_key }}" placeholder="Your The Odds API Key">
                        <small class="text-muted">Get your free API key from the-odds-api.com</small>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Sport</label>
                            <select class="form-select" name="odds_sport">
                                <option value="horse_racing_uk" {% if odds_sport == 'horse_racing_uk' %}selected{% endif %}>UK Horse Racing</option>
                                <option value="horse_racing_us" {% if odds_sport == 'horse_racing_us' %}selected{% endif %}>US Horse Racing</option>
                                <option value="horse_racing_au" {% if odds_sport == 'horse_racing_au' %}selected{% endif %}>Australian Horse Racing</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Update Frequency</label>
                            <select class="form-select" name="update_frequency">
                                <option value="30" {% if update_frequency == '30' %}selected{% endif %}>Every 30 minutes</option>
                                <option value="60" {% if update_frequency == '60' %}selected{% endif %}>Every hour</option>
                                <option value="120" {% if update_frequency == '120' %}selected{% endif %}>Every 2 hours</option>
                            </select>
                        </div>
                    </div>

                    {% if odds_api_status %}
                    <div class="alert {% if '‚úÖ' in odds_api_status %}alert-success{% else %}alert-warning{% endif %}">
                        <strong>The Odds API Status:</strong> {{ odds_api_status }}
                    </div>
                    {% endif %}
                </div>

                <!-- Virtual Racing Section -->
                <div class="virtual-section">
                    <h3>üéÆ Virtual Racing System</h3>
                    <p>Fallback system with realistic race simulation. No external dependencies required.</p>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="use_virtual" name="use_virtual" {% if use_virtual %}checked{% endif %}>
                        <label class="form-check-label fw-bold" for="use_virtual">
                            Enable Virtual Racing (Recommended as fallback)
                        </label>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Racing Mode</label>
                        <select class="form-select" name="racing_mode">
                            <option value="enhanced" {% if racing_mode == 'enhanced' %}selected{% endif %}>
                                Enhanced - Realistic UK racecourses with detailed horse data
                            </option>
                            <option value="demo" {% if racing_mode == 'demo' %}selected{% endif %}>
                                Demo - Simple realistic race generation
                            </option>
                        </select>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-lg me-3">üíæ Save Configuration</button>
                    <a href="/admin/test-api" class="btn btn-info btn-lg me-3">üß™ Test API</a>
                    <a href="/races" class="btn btn-success btn-lg">üèá View Races</a>
                </div>
            </form>

            <!-- Help Section -->
            <div class="mt-5">
                <h4>üìñ Setup Guide</h4>
                <div class="row">
                    <div class="col-md-6">
                        <h5>üèá The Odds API</h5>
                        <ol>
                            <li>Visit <a href="https://the-odds-api.com/" target="_blank">the-odds-api.com</a></li>
                            <li>Sign up for a free account</li>
                            <li>Get your API key from the dashboard</li>
                            <li>Choose your preferred horse racing region</li>
                            <li>Enable the API and test connection</li>
                        </ol>
                        <p><strong>Pro:</strong> Free tier, real racing data, virtual betting friendly<br>
                        <strong>Con:</strong> 500 requests/month limit on free tier</p>
                    </div>
                    <div class="col-md-6">
                        <h5>üéÆ Virtual Racing</h5>
                        <ul>
                            <li>No API key required</li>
                            <li>Realistic UK racecourse simulation</li>
                            <li>Professional horse and jockey names</li>
                            <li>Instant availability</li>
                        </ul>
                        <p><strong>Pro:</strong> Always available, no limits<br>
                        <strong>Con:</strong> Simulated data only</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>



            <div class="mt-4 p-3 bg-light rounded">
                <h6>üìã Setup Instructions:</h6>
                <ol>
                    <li><strong>For The Odds API (Recommended):</strong>
                        <ul>
                            <li>Visit <a href="https://the-odds-api.com/" target="_blank">The Odds API</a></li>
                            <li>Sign up for a free account</li>
                            <li>Get your API key from dashboard</li>
                            <li>Choose horse racing region (UK/US/AU)</li>
                            <li>Perfect for virtual betting applications!</li>
                        </ul>
                    </li>
                    <li><strong>For The Odds API:</strong>
                        <ul>
                            <li>Visit <a href="https://the-odds-api.com/" target="_blank">The Odds API</a></li>
                            <li>Sign up for free (500 requests/month)</li>
                            <li>Note: This API doesn't provide horse racing data</li>
                        </ul>
                    </li>
                    <li>Select your preferred provider above</li>
                    <li>Paste your API key and enable real race data</li>
                    <li>Save and enjoy real horse racing!</li>
                </ol>
                
                {% if provider_info %}
                <div class="alert alert-info mt-2">
                    <strong>‚ÑπÔ∏è Current Provider:</strong> {{ provider_info }}
                </div>
                {% endif %}
                
                {% if sports_info %}
                <div class="alert alert-warning mt-2">
                    <strong>‚ö†Ô∏è Important:</strong> {{ sports_info }}
                </div>
                {% endif %}
                
                <div class="alert alert-success mt-2">
                    <strong>üí° Tip:</strong> The Odds API provides real horse racing data and odds perfect for virtual betting games. The app automatically falls back to virtual races if the API is unavailable.
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Update API instructions based on selected provider
        document.getElementById('api_provider').addEventListener('change', function() {
            const provider = this.value;
            const instructions = document.getElementById('api-instructions');
            
            if (provider === 'theodds') {
                instructions.innerHTML = `
                    Get your free API key from <a href="https://the-odds-api.com/" target="_blank">The Odds API</a>
                    <br>Free tier available with real horse racing data
                `;
            } else {
                instructions.innerHTML = `
                    Get your free API key from <a href="https://the-odds-api.com/" target="_blank">The Odds API</a>
                    <br>Supports horse racing odds and data perfect for virtual betting
                `;
            }
        });
    </script>
</body>
</html>
